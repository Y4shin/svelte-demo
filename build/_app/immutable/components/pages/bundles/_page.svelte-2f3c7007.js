import{S as fe,i as he,s as me,v as M,a as C,e as W,w as F,c as K,x as G,b as T,f as w,t as _,d as L,y as S,h as x,o as ge,g as O,k as $,q as R,l as E,m as P,r as N,n as k,I,H as Q,$ as re,J as X,N as de,u as ue}from"../../../chunks/index-e0c3bc23.js";import{S as xe,B as ye}from"../../../chunks/sidemargincontainer-3e06a851.js";import{d as m}from"../../../chunks/db-6dba99b9.js";/* empty css                                                             */import{s as H}from"../../../chunks/notification-6b496d13.js";import{M as we}from"../../../chunks/modal-01a6fc60.js";import{B as J}from"../../../chunks/badge-326699bd.js";import{g as be}from"../../../chunks/fetchDisplayData-17482217.js";import"../../../chunks/index-ceed3e71.js";const j=[{access:{type:"pin",pin:"1234"},bundle:{type:"fullBundle",version:1,compilationTime:1663153489,course:{id:"mmde-wise-2022-2023",title:"Mathematische Methoden der Elektrotechnik (WiSe 2022/2023)",shortTitle:"MMDE",lessons:[{id:"elementare-rechentechniken",title:"Elementare Rechentechniken",orderKey:0,shortTitle:"01: ER",tasks:[{id:"01",name:"Elementare Rechentechniken: 1",orderKey:0,nextId:"02",data:{type:"singleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Wie hei\xDFt diese Rechenregel?"}]},{type:"mathDisplay",math:"a+(b+c)=(a+b)+c"}],incorrectAnswers:[{text:[{type:"plainText",text:"Kommutativgesetz"}],correct:!1,id:"b"},{text:[{type:"plainText",text:"Distributivgesetz"}],correct:!1,id:"c"},{text:[{type:"plainText",text:"Faktorisierungsgesetz"}],correct:!1,id:"d"}],correctAnswer:{text:[{type:"plainText",text:"Assoziativgesetz"}],correct:!0,id:"a"}}},{id:"02",name:"Elementare Rechentechniken: 2",orderKey:1,nextId:"03",prevId:"01",data:{type:"singleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Wie hei\xDFt das Verfahren, bei dem l\xE4ngere Terme durch das hinzuf\xFCgen von Klammern zusammengefasst werden?"}]}],incorrectAnswers:[{text:[{type:"plainText",text:"Ausmultiplizieren"}],correct:!1,id:"b"},{text:[{type:"plainText",text:"Kommutativgesetz"}],correct:!1,id:"c"},{text:[{type:"plainText",text:"Integration"}],correct:!1,id:"d"}],correctAnswer:{text:[{type:"plainText",text:"Faktorisierung"}],correct:!0,id:"a"}}},{id:"03",name:"Elementare Rechentechniken: 3",orderKey:2,nextId:"04",prevId:"02",data:{type:"multipleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Welche der Antwortterme sind gleich diesem Term?"}]},{type:"mathDisplay",math:"(2x+y)(4-3z)"}],incorrectAnswers:[{text:[{type:"mathText",math:"6x-4xz+2y-yz"}],correct:!1,id:"d"}],correctAnswers:[{text:[{type:"mathText",math:"8x-6xz+4y-3yz"}],correct:!0,id:"a"},{text:[{type:"mathText",math:"y(4-3z)+8x-6xz"}],correct:!0,id:"b"},{text:[{type:"mathText",math:"2x(4-3z)+4y-3yz"}],correct:!0,id:"c"}]}},{id:"04",name:"Elementare Rechentechniken: 4",orderKey:3,prevId:"03",data:{type:"dragAndDrop",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Vervollst\xE4ndigen Sie die folgende Gleichung."}]}],dndText:[{type:"dndMath",mathData:{type:"dndMathOperation",left:{type:"dndMathOperation",left:{type:"dropZone",id:"a",allowedItemIds:["6","5","x","y"],correctItemIds:["6"]},right:{type:"dropZone",id:"b",allowedItemIds:["6","5","x","y"],correctItemIds:["5"]},operator:"(x+"},right:{type:"dndMathOperation",left:{type:"dropZone",id:"c",allowedItemIds:["6","5","x","y"],correctItemIds:["x"]},right:{type:"dropZone",id:"d",allowedItemIds:["6","5","x","y"],correctItemIds:["y"]},operator:"+30"},operator:"y)-3x=3"}}],items:[{id:"6",text:[{type:"mathText",math:"6"}]},{id:"5",text:[{type:"mathText",math:"5"}]},{id:"x",text:[{type:"mathText",math:"x"}]},{id:"y",text:[{type:"mathText",math:"y"}]}]}}]}]}},title:"Elementare Rechentechniken"},{access:{type:"pin",pin:"1234"},bundle:{type:"patchBundle",fromVersion:1,toVersion:2,compilationTime:1663160689,course:{id:"mmde-wise-2022-2023",title:"Mathematische Methoden der Elektrotechnik (WiSe 2022/2023)",shortTitle:"MMDE",lessons:[{id:"elementare-rechentechniken",title:"Elementare Rechentechniken",orderKey:0,shortTitle:"01: ER",tasks:[{patch:"update",resetProgress:!1,id:"04",name:"Elementare Rechentechniken: 4",orderKey:3,prevId:"03",nextId:"05",data:{type:"dragAndDrop",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Vervollst\xE4ndigen Sie die folgende Gleichung."}]}],dndText:[{type:"dndMath",mathData:{type:"dndMathOperation",left:{type:"dndMathOperation",left:{type:"dropZone",id:"a",allowedItemIds:["6","5","x","y"],correctItemIds:["6"]},right:{type:"dropZone",id:"b",allowedItemIds:["6","5","x","y"],correctItemIds:["5"]},operator:"(x+"},right:{type:"dndMathOperation",left:{type:"dropZone",id:"c",allowedItemIds:["6","5","x","y"],correctItemIds:["x"]},right:{type:"dropZone",id:"d",allowedItemIds:["6","5","x","y"],correctItemIds:["y"]},operator:"+30"},operator:"y)-3x=3"}}],items:[{id:"6",text:[{type:"mathText",math:"6"}]},{id:"5",text:[{type:"mathText",math:"5"}]},{id:"x",text:[{type:"mathText",math:"x"}]},{id:"y",text:[{type:"mathText",math:"y"}]}]}},{patch:"create",resetProgress:!1,id:"05",name:"Elementare Rechentechniken: 5",orderKey:4,prevId:"04",data:{type:"multipleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Welche der folgenden Gesetze oder Umformungstechniken wurden hier angewendet?"}]},{type:"mathDisplay",math:"5(x+3)+3 = 18+5x"}],incorrectAnswers:[{text:[{type:"plainText",text:"Assoziativgesetz"}],correct:!1,id:"a"},{text:[{type:"plainText",text:"Faktorisieren"}],correct:!1,id:"d"}],correctAnswers:[{text:[{type:"plainText",text:"Ausmultiplizieren"}],correct:!0,id:"b"},{text:[{type:"plainText",text:"Kommutativgesetz"}],correct:!0,id:"c"}]}}]}]}},title:"Elementare Rechentechniken: Update"},{access:{type:"pin",pin:"1234"},bundle:{type:"patchBundle",fromVersion:2,toVersion:3,compilationTime:1663160689,course:{id:"mmde-wise-2022-2023",title:"Mathematische Methoden der Elektrotechnik (WiSe 2022/2023)",shortTitle:"MMDE",lessons:[{patch:"create",id:"gleichungssysteme",title:"Gleichungssysteme",orderKey:1,shortTitle:"02: GS",tasks:[{patch:"create",resetProgress:!1,id:"01",name:"Gleichungssysteme: 1",orderKey:0,nextId:"02",data:{type:"multipleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Welche der Aussagen trifft auf lineare Gleichungssysteme zu?"}]}],incorrectAnswers:[{text:[{type:"plainText",text:"Ein lineares Gleichungssystem ist eine Menge an Gleichungen, die gleichzeitig erf\xFCllt sein m\xFCssen."}],correct:!1,id:"a"},{text:[{type:"plainText",text:"Die unbekannten d\xFCrfen in beliebiger Form in den Gleichungen vorkommen."}],correct:!1,id:"d"}],correctAnswers:[{text:[{type:"plainText",text:"Ein lineares Gleichungssystem ist eine Menge an linearen Gleichungen, die gleichzeitig erf\xFCllt sein m\xFCssen."}],correct:!0,id:"b"},{text:[{type:"plainText",text:"Ein lineares Gleichungssystem hat eine oder mehrere Unbekannte."}],correct:!0,id:"c"}]}},{patch:"create",resetProgress:!1,id:"02",name:"Gleichungssysteme: 2",orderKey:1,prevId:"01",data:{type:"multipleChoice",questionText:[{type:"paragraph",data:[{type:"plainText",text:"Welche der folgenden Begriffe sind L\xF6sungsverfahren f\xFCr lineare Gleichungssysteme?"}]}],incorrectAnswers:[{text:[{type:"plainText",text:"Der Gau\xDFsche Algorithmus"}],correct:!1,id:"a"},{text:[{type:"plainText",text:"Das Gleichsetzungsverfahren"}],correct:!1,id:"b"}],correctAnswers:[{text:[{type:"plainText",text:"Das Substitutionsverfahren"}],correct:!0,id:"c"},{text:[{type:"plainText",text:"Der Euklidische Algorithmus"}],correct:!0,id:"d"}]}}]}]}},title:"Gleichungssysteme: Update"}];class B extends Error{constructor(t,i,e){super(t),this.error=i,this.detais=e}}const _e=async s=>{const t=await m.course.where("cID").equals(s.course.id).toArray(),i=await m.lesson.where("cID").equals(s.course.id).toArray(),e=await m.task.where("cID").equals(s.course.id).toArray(),r=await m.taskProgress.where("cID").equals(s.course.id).toArray(),l=async()=>{try{await m.course.where("cID").equals(s.course.id).delete(),await m.lesson.where("cID").equals(s.course.id).delete(),await m.task.where("cID").equals(s.course.id).delete(),await m.taskProgress.where("cID").equals(s.course.id).delete(),await m.course.bulkAdd(t),await m.lesson.bulkAdd(i),await m.task.bulkAdd(e),await m.taskProgress.bulkAdd(r)}catch{throw new B("Fatal Error occured while enacting Backup","fatal")}};try{if(s.type==="fullBundle"){if(await m.course.where("cID").equals(s.course.id).first())throw new B(`Course ${s.course.id} already exists`,"courseAlreadyExists");try{await m.course.add({cID:s.course.id,title:s.course.title,version:s.version,shortTitle:s.course.shortTitle,progressCurrent:0,progressTotal:s.course.lessons.reduce((n,d)=>n+d.tasks.length,0)}),await Promise.all(s.course.lessons.map(async n=>{await m.lesson.add({cID:s.course.id,lID:n.id,title:n.title,orderKey:n.orderKey,shortTitle:n.shortTitle,description:n.description,progressCurrent:0,progressTotal:n.tasks.length}),await Promise.all(n.tasks.map(async d=>{await m.task.add({cID:s.course.id,lID:n.id,qID:d.id,name:d.name,orderKey:d.orderKey,status:"notstarted",nextId:d.nextId,prevId:d.prevId,data:d.data})}))}))}catch{throw new B("Unspecified Failure importing new bundle.","failure")}}else if(s.type==="patchBundle"){const a=await m.course.where("cID").equals(s.course.id).first();if(!a)throw new B(`Course ${s.course.id} does not exist to be updated.`,"courseNotExists");if(a.version!==s.fromVersion)throw new B(`Cannot update course ${s.course.id} from version ${a.version} with an update bundle meant for version ${s.fromVersion}.`,"incompatiblePatch",{localVersion:a.version,bundleVersion:s.fromVersion});let n=0,d=0;await Promise.all(s.course.lessons.map(async o=>{let c=0,v=0;const p=await m.lesson.where(["cID","lID"]).equals([s.course.id,o.id]).first();if(await Promise.all(o.tasks.map(async u=>{var g,h;const f=await m.task.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).first();if(u.patch==="create"){if(f)throw new B(`Task ${u.id} in lesson ${o.id} already exists in course ${s.course.id}.`,"failure");await m.task.add({cID:s.course.id,lID:o.id,qID:u.id,name:u.name,orderKey:u.orderKey,status:"notstarted",nextId:u.nextId,prevId:u.prevId,data:u.data}),v++}else if(u.patch==="update"){if(!f)throw new B(`Task ${u.id} in lesson ${o.id} does not exist in course ${s.course.id}.`,"failure");await m.task.update(f,{name:u.name,orderKey:u.orderKey,nextId:u.nextId,prevId:u.prevId,data:u.data});const y=await m.taskProgress.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).first(),q=(g=y==null?void 0:y.feedback)==null?void 0:g.reduce((b,U)=>b||U.correct||!1,!1);await m.taskProgress.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).delete(),q&&u.resetProgress&&c--}else if(u.patch==="delete"){if(!f)throw new B(`Task ${u.id} in lesson ${o.id} does not exist in course ${s.course.id}.`,"failure");await m.task.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).delete();const y=await m.taskProgress.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).first(),q=(h=y==null?void 0:y.feedback)==null?void 0:h.reduce((b,U)=>b||U.correct||!1,!1);await m.taskProgress.where(["cID","lID","qID"]).equals([s.course.id,o.id,u.id]).delete(),q&&c--,v--}})),o.patch==="update"){if(!p)throw new B(`Lesson ${o.id} to be modified does not exist.`,"failure");await m.lesson.update(p,{title:o.title,orderKey:o.orderKey,shortTitle:o.shortTitle,description:o.description,progressCurrent:p.progressCurrent+c,progressTotal:p.progressTotal+v})}else if(o.patch==="delete"){if(!p)throw new B(`Lesson ${o.id} to be deleted does not exist.`,"failure");await m.lesson.where(["cID","lID"]).equals([s.course.id,o.id]).delete()}else if(o.patch==="create"){if(p)throw new B("Lesson already exists","failure");await m.lesson.add({cID:s.course.id,lID:o.id,title:o.title,orderKey:o.orderKey,shortTitle:o.shortTitle,description:o.description,progressCurrent:0,progressTotal:v})}else if(c!==0||v!==0){if(!p)throw new B("Lesson does not exist","failure");await m.lesson.update(p,{progressCurrent:p.progressCurrent+c,progressTotal:p.progressTotal+v})}n+=c,d+=v})),s.course.patch==="update"?await m.course.update(a,{title:s.course.title,shortTitle:s.course.shortTitle,version:s.toVersion,progressCurrent:a.progressCurrent+n,progressTotal:a.progressTotal+d}):await m.course.update(a,{version:s.toVersion})}}catch(a){throw await l(),a}return"success"};function se(s,t,i){const e=s.slice();return e[12]=t[i],e}function ie(s,t,i){const e=s.slice();return e[15]=t[i],e}function ae(s){let t,i,e=s[4],r=[];for(let a=0;a<e.length;a+=1)r[a]=ne(se(s,e,a));const l=a=>_(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();t=W()},l(a){for(let n=0;n<r.length;n+=1)r[n].l(a);t=W()},m(a,n){for(let d=0;d<r.length;d+=1)r[d].m(a,n);T(a,t,n),i=!0},p(a,n){if(n&48){e=a[4];let d;for(d=0;d<e.length;d+=1){const o=se(a,e,d);r[d]?(r[d].p(o,n),w(r[d],1)):(r[d]=ne(o),r[d].c(),w(r[d],1),r[d].m(t.parentNode,t))}for(O(),d=e.length;d<r.length;d+=1)l(d);L()}},i(a){if(!i){for(let n=0;n<e.length;n+=1)w(r[n]);i=!0}},o(a){r=r.filter(Boolean);for(let n=0;n<r.length;n+=1)_(r[n]);i=!1},d(a){de(r,a),a&&x(t)}}}function le(s){let t,i;return t=new J({props:{value:"Pin ben\xF6tigt",color:"bg-sec-war-lgt"}}),{c(){M(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){G(t,e,r),i=!0},i(e){i||(w(t.$$.fragment,e),i=!0)},o(e){_(t.$$.fragment,e),i=!1},d(e){S(t,e)}}}function Ie(s){let t,i;return t=new J({props:{value:"Update von Version "+s[15].bundle.fromVersion+" zu "+s[15].bundle.toVersion,color:"bg-luh-pri-hgl-lgt"}}),{c(){M(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){G(t,e,r),i=!0},p(e,r){const l={};r&16&&(l.value="Update von Version "+e[15].bundle.fromVersion+" zu "+e[15].bundle.toVersion),t.$set(l)},i(e){i||(w(t.$$.fragment,e),i=!0)},o(e){_(t.$$.fragment,e),i=!1},d(e){S(t,e)}}}function ke(s){let t,i,e,r;return t=new J({props:{value:"Neuer Kurs",color:"bg-luh-pri-hgl-lgt"}}),e=new J({props:{value:"Version "+s[15].bundle.version,color:"bg-luh-pri-hgl-lgt"}}),{c(){M(t.$$.fragment),i=C(),M(e.$$.fragment)},l(l){F(t.$$.fragment,l),i=K(l),F(e.$$.fragment,l)},m(l,a){G(t,l,a),T(l,i,a),G(e,l,a),r=!0},p(l,a){const n={};a&16&&(n.value="Version "+l[15].bundle.version),e.$set(n)},i(l){r||(w(t.$$.fragment,l),w(e.$$.fragment,l),r=!0)},o(l){_(t.$$.fragment,l),_(e.$$.fragment,l),r=!1},d(l){S(t,l),l&&x(i),S(e,l)}}}function oe(s){let t,i,e,r=s[15].title+"",l,a,n,d,o,c,v,p,u,f,g,h,y,q,b=s[15].access.type==="pin"&&le();const U=[ke,Ie],V=[];function Y(A,D){return A[15].bundle.type==="fullBundle"?0:A[15].bundle.type==="patchBundle"?1:-1}~(o=Y(s))&&(c=V[o]=U[o](s));function pe(){return s[6](s[15])}return{c(){t=$("div"),i=$("div"),e=$("span"),l=R(r),a=C(),n=$("div"),b&&b.c(),d=C(),c&&c.c(),v=C(),p=$("button"),u=R("Paket laden"),g=C(),this.h()},l(A){t=E(A,"DIV",{class:!0});var D=P(t);i=E(D,"DIV",{class:!0});var z=P(i);e=E(z,"SPAN",{class:!0});var ee=P(e);l=N(ee,r),ee.forEach(x),a=K(z),n=E(z,"DIV",{class:!0});var Z=P(n);b&&b.l(Z),d=K(Z),c&&c.l(Z),Z.forEach(x),z.forEach(x),v=K(D),p=E(D,"BUTTON",{class:!0});var te=P(p);u=N(te,"Paket laden"),te.forEach(x),g=K(D),D.forEach(x),this.h()},h(){k(e,"class","text-left font-bold"),k(n,"class","flex flex-row gap-2"),k(i,"class","grow flex flex-col items-start gap-2"),k(p,"class",f=(s[15].enable?"hover:bg-luh-acc-hgl-lgt hover:dark:bg-luh-acc-hgl-drk bg-luh-acc-lgt dark:bg-luh-acc-drk text-text-on-acc-lgt dark:text-text-drk":"bg-sec-disabled-lgt dark:bg-sec-disabled-drk")+" rounded-2xl border border-luh-bdr-lgt dark:border-luh-bdr-drk px-5 py-2"),k(t,"class","flex justify-between items-center border-t-2 border-luh-bdr-lgt dark:border-luh-bdr-drk px-2 py-4 gap-4 md:py-2")},m(A,D){T(A,t,D),I(t,i),I(i,e),I(e,l),I(i,a),I(i,n),b&&b.m(n,null),I(n,d),~o&&V[o].m(n,null),I(t,v),I(t,p),I(p,u),I(t,g),h=!0,y||(q=X(p,"click",pe),y=!0)},p(A,D){s=A,(!h||D&16)&&r!==(r=s[15].title+"")&&ue(l,r),s[15].access.type==="pin"?b?D&16&&w(b,1):(b=le(),b.c(),w(b,1),b.m(n,d)):b&&(O(),_(b,1,1,()=>{b=null}),L());let z=o;o=Y(s),o===z?~o&&V[o].p(s,D):(c&&(O(),_(V[z],1,1,()=>{V[z]=null}),L()),~o?(c=V[o],c?c.p(s,D):(c=V[o]=U[o](s),c.c()),w(c,1),c.m(n,null)):c=null),(!h||D&16&&f!==(f=(s[15].enable?"hover:bg-luh-acc-hgl-lgt hover:dark:bg-luh-acc-hgl-drk bg-luh-acc-lgt dark:bg-luh-acc-drk text-text-on-acc-lgt dark:text-text-drk":"bg-sec-disabled-lgt dark:bg-sec-disabled-drk")+" rounded-2xl border border-luh-bdr-lgt dark:border-luh-bdr-drk px-5 py-2"))&&k(p,"class",f)},i(A){h||(w(b),w(c),h=!0)},o(A){_(b),_(c),h=!1},d(A){A&&x(t),b&&b.d(),~o&&V[o].d(),y=!1,q()}}}function Te(s){let t,i,e,r=s[12].courseTitle+"",l,a,n,d,o=s[12].bundles,c=[];for(let p=0;p<o.length;p+=1)c[p]=oe(ie(s,o,p));const v=p=>_(c[p],1,1,()=>{c[p]=null});return{c(){t=$("div"),i=$("div"),e=$("h2"),l=R(r),a=C();for(let p=0;p<c.length;p+=1)c[p].c();n=C(),this.h()},l(p){t=E(p,"DIV",{class:!0});var u=P(t);i=E(u,"DIV",{class:!0});var f=P(i);e=E(f,"H2",{class:!0});var g=P(e);l=N(g,r),g.forEach(x),f.forEach(x),a=K(u);for(let h=0;h<c.length;h+=1)c[h].l(u);u.forEach(x),n=K(p),this.h()},h(){k(e,"class","text-center text-2xl mb-2"),k(i,"class","w-full p-2"),k(t,"class","flex flex-col w-full")},m(p,u){T(p,t,u),I(t,i),I(i,e),I(e,l),I(t,a);for(let f=0;f<c.length;f+=1)c[f].m(t,null);T(p,n,u),d=!0},p(p,u){if((!d||u&16)&&r!==(r=p[12].courseTitle+"")&&ue(l,r),u&48){o=p[12].bundles;let f;for(f=0;f<o.length;f+=1){const g=ie(p,o,f);c[f]?(c[f].p(g,u),w(c[f],1)):(c[f]=oe(g),c[f].c(),w(c[f],1),c[f].m(t,null))}for(O(),f=o.length;f<c.length;f+=1)v(f);L()}},i(p){if(!d){for(let u=0;u<o.length;u+=1)w(c[u]);d=!0}},o(p){c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)_(c[u]);d=!1},d(p){p&&x(t),de(c,p),p&&x(n)}}}function ne(s){let t,i;return t=new ye({props:{padding:{type:"global",value:0},$$slots:{default:[Te]},$$scope:{ctx:s}}}),{c(){M(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){G(t,e,r),i=!0},p(e,r){const l={};r&262160&&(l.$$scope={dirty:r,ctx:e}),t.$set(l)},i(e){i||(w(t.$$.fragment,e),i=!0)},o(e){_(t.$$.fragment,e),i=!1},d(e){S(t,e)}}}function ve(s){let t,i,e=s[3]&&ae(s);return{c(){e&&e.c(),t=W()},l(r){e&&e.l(r),t=W()},m(r,l){e&&e.m(r,l),T(r,t,l),i=!0},p(r,l){r[3]?e?(e.p(r,l),l&8&&w(e,1)):(e=ae(r),e.c(),w(e,1),e.m(t.parentNode,t)):e&&(O(),_(e,1,1,()=>{e=null}),L())},i(r){i||(w(e),i=!0)},o(r){_(e),i=!1},d(r){e&&e.d(r),r&&x(t)}}}function De(s){let t,i;return{c(){t=$("h1"),i=R("Kurspakete Laden"),this.h()},l(e){t=E(e,"H1",{class:!0});var r=P(t);i=N(r,"Kurspakete Laden"),r.forEach(x),this.h()},h(){k(t,"class","text-center text-2xl my-4")},m(e,r){T(e,t,r),I(t,i)},p:Q,d(e){e&&x(t)}}}function ce(s){let t,i;return t=new we({props:{$$slots:{customButton:[Pe],title:[Ee],default:[$e]},$$scope:{ctx:s}}}),t.$on("close",s[9]),{c(){M(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){G(t,e,r),i=!0},p(e,r){const l={};r&262151&&(l.$$scope={dirty:r,ctx:e}),t.$set(l)},i(e){i||(w(t.$$.fragment,e),i=!0)},o(e){_(t.$$.fragment,e),i=!1},d(e){S(t,e)}}}function $e(s){let t,i,e,r,l,a,n,d;return{c(){t=$("div"),i=C(),e=$("p"),r=R("F\xFCr dieses Paket m\xFCssen Sie eine Pin eingeben:"),l=C(),a=$("input"),this.h()},l(o){t=E(o,"DIV",{class:!0}),P(t).forEach(x),i=K(o),e=E(o,"P",{});var c=P(e);r=N(c,"F\xFCr dieses Paket m\xFCssen Sie eine Pin eingeben:"),c.forEach(x),l=K(o),a=E(o,"INPUT",{class:!0,type:!0,placeholder:!0}),this.h()},h(){k(t,"class","flex flex-col gap-4 items-center"),k(a,"class","appearance-none border-2 border-luh-bdr-lgt dark:border-luh-bdr-drk bg-luh-pri-hgl-lgt dark:bg-luh-pri-hgl-drk rounded-2xl px-4 py-2 w-full"),k(a,"type","text"),k(a,"placeholder","Pin")},m(o,c){T(o,t,c),T(o,i,c),T(o,e,c),I(e,r),T(o,l,c),T(o,a,c),re(a,s[1]),n||(d=X(a,"input",s[8]),n=!0)},p(o,c){c&2&&a.value!==o[1]&&re(a,o[1])},d(o){o&&x(t),o&&x(i),o&&x(e),o&&x(l),o&&x(a),n=!1,d()}}}function Ee(s){let t,i;return{c(){t=$("h3"),i=R("Pin Eingabe"),this.h()},l(e){t=E(e,"H3",{class:!0});var r=P(t);i=N(r,"Pin Eingabe"),r.forEach(x),this.h()},h(){k(t,"class","text-xl font-semibold text-gray-900 dark:text-white")},m(e,r){T(e,t,r),I(t,i)},p:Q,d(e){e&&x(t)}}}function Pe(s){let t,i,e,r;return{c(){t=$("button"),i=R("Absenden"),this.h()},l(l){t=E(l,"BUTTON",{class:!0});var a=P(t);i=N(a,"Absenden"),a.forEach(x),this.h()},h(){k(t,"class","text-text-on-acc-lgt dark:text-text-drk bg-luh-acc-lgt dark:bg-luh-acc-drk hover:bg-luh-acc-hgl-lgt hover:dark:bg-luh-acc-hgl-drk rounded-2xl border border-luh-bdr-lgt dark:border-luh-bdr-drk text-sm font-medium px-5 py-2.5")},m(l,a){T(l,t,a),I(t,i),e||(r=X(t,"click",s[7]),e=!0)},p:Q,d(l){l&&x(t),e=!1,r()}}}function qe(s){let t,i,e,r;t=new xe({props:{$$slots:{title:[De],default:[ve]},$$scope:{ctx:s}}});let l=s[2]&&ce(s);return{c(){M(t.$$.fragment),i=C(),l&&l.c(),e=W()},l(a){F(t.$$.fragment,a),i=K(a),l&&l.l(a),e=W()},m(a,n){G(t,a,n),T(a,i,n),l&&l.m(a,n),T(a,e,n),r=!0},p(a,[n]){const d={};n&262168&&(d.$$scope={dirty:n,ctx:a}),t.$set(d),a[2]?l?(l.p(a,n),n&4&&w(l,1)):(l=ce(a),l.c(),w(l,1),l.m(e.parentNode,e)):l&&(O(),_(l,1,1,()=>{l=null}),L())},i(a){r||(w(t.$$.fragment,a),w(l),r=!0)},o(a){_(t.$$.fragment,a),_(l),r=!1},d(a){S(t,a),a&&x(i),l&&l.d(a),a&&x(e)}}}function Ae(s,t,i){let e=-1,r=null,l=!1,a,n=!1,d=[];const o=async(g,h)=>{try{if(i(2,l=!1),j[g].access.type==="pin")if(r){if(h!==j[g].access.pin){H({message:"Falscher PIN.",type:"error"},3e3);return}}else{i(0,e=g),i(2,l=!0);return}i(3,n=!1),await _e(j[g].bundle),H({message:"Kurspaket wurde geladen.",type:"success"},3e3)}catch(y){y.error==="courseAlreadyExists"?H({message:"Kurs existiert bereits.",type:"error"},1e4):y.error==="incompatiblePatch"||(console.log(y),H({message:"Unbekannter Fehler.",type:"error"},1e4))}await c()},c=async()=>{i(3,n=!1),a=await be(),i(4,d=[]),j.forEach((g,h)=>{const y=d.find(q=>q.courseId===g.bundle.course.id);y?y.bundles.push({...g,visible:!0,enable:!0,index:h}):d.push({courseId:g.bundle.course.id,courseTitle:g.bundle.course.title,bundles:[{...g,visible:!0,enable:!0,index:h}]})}),i(4,d=d.map(g=>({...g,bundles:g.bundles.sort((h,y)=>h.bundle.type==="fullBundle"&&y.bundle.type==="fullBundle"?h.bundle.version-y.bundle.version:h.bundle.type==="fullBundle"?-1:y.bundle.type==="fullBundle"?1:h.bundle.fromVersion-y.bundle.fromVersion).map(h=>{if(h.bundle.type==="fullBundle")a.find(q=>q.id===h.bundle.course.id)&&(h.enable=!1);else if(h.bundle.type==="patchBundle"){const y=a.find(q=>q.id===h.bundle.course.id);y?y.version!==h.bundle.fromVersion&&(h.enable=!1):h.enable=!1}return h})}))),i(3,n=!0)};ge(async()=>{c()});const v=g=>o(g.index),p=()=>{const g=e;i(0,e=-1),o(g,r||void 0),i(1,r=null),i(2,l=!1)};function u(){r=this.value,i(1,r)}return[e,r,l,n,d,o,v,p,u,()=>{i(0,e=-1),i(1,r=null),i(2,l=!1)}]}class Re extends fe{constructor(t){super(),he(this,t,Ae,qe,me,{})}}export{Re as default};
